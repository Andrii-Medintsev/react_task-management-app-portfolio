(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var o,c=n(0),i=n(7),a=n.n(i),r=(n(30),n(31),n(32),n(33),n(34),n(12)),l=n(8),s=n(5),u=n(3),d=n(23),j=n(41),m=n(40),b=n(22),f=n.n(b),p=n(1),h=function(e){var t=e.todo,n=e.onHandleToggleComplete,o=e.onDeleteTodo,i=e.onPatchTodo,a=Object(c.useState)(!1),r=Object(u.a)(a,2),l=r[0],s=r[1],d=Object(c.useState)(t.title),j=Object(u.a)(d,2),m=j[0],b=j[1];return Object(p.jsxs)("li",{className:f()({completed:t.completed},{editing:l}),children:[Object(p.jsxs)("div",{className:"view",children:[Object(p.jsx)("input",{type:"checkbox",className:"toggle",id:"toggle-view",checked:t.completed,onChange:function(){return n(t.id)}}),Object(p.jsx)("span",{onDoubleClick:function(){return s(!0)},children:m}),Object(p.jsx)("button",{type:"button",className:"destroy","data-cy":"deleteTodo","aria-label":"destroy-button",onClick:function(){return o(t.id)}})]}),l&&Object(p.jsx)("input",{autoFocus:!0,type:"text",className:"edit",value:m,onChange:function(e){return b(e.target.value)},onKeyDown:function(e){return"Escape"===e.key?(b(t.title),void s(!1)):"Enter"!==e.key||m?void("Enter"===e.key&&(i(t.id,m),s(!1))):(o(t.id),void s(!1))},onBlur:function(){if(!m)return o(t.id),void s(!1);m!==t.title?(i(t.id,m),s(!1)):s(!1)}})]})},O=function(e){var t=e.todos,n=e.isSomeTodos,o=e.areAllCompleted,c=e.onToggleComplete,i=e.onToggleAll,a=e.onDeleteTodo,r=e.onPatchTodo;return Object(p.jsxs)("section",{className:"main",children:[n&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("input",{type:"checkbox",id:"toggle-all",className:"toggle-all","data-cy":"toggleAll",checked:o,onChange:i}),Object(p.jsx)("label",{htmlFor:"toggle-all",children:"Mark all as complete"})]}),Object(p.jsx)("ul",{className:"todo-list","data-cy":"todoList",children:Object(p.jsx)(j.a,{children:t.map((function(e){return Object(p.jsx)(m.a,{timeout:800,classNames:"item",children:Object(p.jsx)(h,{todo:e,onHandleToggleComplete:c,onDeleteTodo:a,onPatchTodo:r},e.id)},e.id)}))})})]})};!function(e){e.ALL="all",e.ACTIVE="active",e.COMPLETED="completed"}(o||(o={}));var T,g=function(e){var t=e.activeTodosAmount,n=e.completedTodosAmount,c=e.onFilterTodos,i=e.onClearCompletedTodos;return Object(p.jsxs)("footer",{className:"footer",children:[Object(p.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:1===t?"1 item left":"".concat(t," items left")}),Object(p.jsxs)("ul",{className:"filters",children:[Object(p.jsx)("li",{children:Object(p.jsx)(r.b,{to:"/",className:function(e){return e.isActive?"selected":""},onClick:function(){return c(o.ALL)},children:"All"})}),Object(p.jsx)("li",{children:Object(p.jsx)(r.b,{to:"/active",className:function(e){return e.isActive?"selected":""},onClick:function(){return c(o.ACTIVE)},children:"Active"})}),Object(p.jsx)("li",{children:Object(p.jsx)(r.b,{to:"/completed",className:function(e){return e.isActive?"selected":""},onClick:function(){return c(o.COMPLETED)},children:"Completed"})})]}),n>0&&Object(p.jsx)("button",{type:"button",className:"clear-completed",onClick:i,children:"Clear completed"})]})},x=function(e){var t=e.newTodoTitle,n=e.onTitleChange,o=e.onFormSubmit;return Object(p.jsx)("header",{className:"header",children:Object(p.jsx)("form",{onSubmit:o,children:Object(p.jsx)("input",{autoFocus:!0,type:"text","data-cy":"createTodo",className:"new-todo",placeholder:"What needs to be done?",value:t,onChange:function(e){return n(e.target.value)}})})})};!function(e){e.None="",e.EmptyTitle="Title can't be empty",e.NoUser="No such user",e.NoTodos="No current todos",e.UnableCompleteAction="Something went wrong"}(T||(T={}));function v(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET"};return t&&(n.body=JSON.stringify(t),n.headers={"Content-Type":"application/json; charset=UTF-8"}),fetch("https://mate.academy/students-api"+e,n).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var C=function(e){return v(e)},y=function(e,t){return v(e,"POST",t)},N=function(e,t){return v(e,"PATCH",t)},A=function(e){return v(e,"DELETE")},k=function(e){return A("/todos/".concat(e))},E=function(e,t){return N("/todos/".concat(e),{completed:t})},S=function(){var e=Object(c.useRef)(null),t=Object(c.useState)(!1),n=Object(u.a)(t,2),i=n[0],a=n[1],r=Object(c.useState)(""),j=Object(u.a)(r,2),m=j[0],b=j[1],f=Object(c.useState)([]),h=Object(u.a)(f,2),v=h[0],A=h[1],S=Object(c.useState)(""),w=Object(u.a)(S,2),L=w[0],D=w[1],P=Object(c.useState)(o.ALL),F=Object(u.a)(P,2),U=F[0],I=F[1],_=Object(c.useState)(T.None),M=Object(u.a)(_,2),J=M[0],V=M[1],H={transition:"opacity 300ms ease-in-out",opacity:0},B={entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0}},R=function(e){e!==T.None&&(a(!0),V(e),setTimeout((function(){a(!1)}),3e3))},G=function(e){A(e),localStorage.setItem("todos",JSON.stringify(e))};Object(c.useEffect)((function(){var e;switch((e=3,C("/users/".concat(e))).then((function(e){return b(e.name)})).catch((function(){return R(T.NoUser)})),function(e){return C("/todos?userId=".concat(e))}(3).then((function(e){return G(e)})).catch((function(){return R(T.NoTodos)})),window.location.hash){case"#/active":I(o.ACTIVE);break;case"#/completed":I(o.COMPLETED);break;default:I(o.ALL)}}),[]);var K=function(e,t){switch(e){case o.ACTIVE:return t.filter((function(e){return!1===e.completed}));case o.COMPLETED:return t.filter((function(e){return!0===e.completed}));default:return t}}(U,v),W=v.filter((function(e){return!e.completed})),q=v.filter((function(e){return e.completed})),z=v.every((function(e){return e.completed}));return Object(p.jsxs)("div",{className:"todoapp",children:[m&&Object(p.jsxs)(p.Fragment,{children:[m?Object(p.jsx)("h1",{className:"todoapp__title",children:"".concat(m,"'s tasks")}):Object(p.jsx)("h1",{className:"no-user",children:"tasks"}),Object(p.jsx)(x,{newTodoTitle:L,onTitleChange:D,onFormSubmit:function(e){if(e.preventDefault(),R(T.None),!L.trim())return D(""),void R(T.EmptyTitle);var t;(t={userId:3,title:L,completed:!1},y("/todos",t)).then((function(e){var t={id:e.id,title:e.title,completed:e.completed};G([].concat(Object(s.a)(v),[t]))})).catch((function(){R(T.UnableCompleteAction)})).finally((function(){return D("")}))}}),Object(p.jsx)(O,{todos:K,isSomeTodos:v.length>0,areAllCompleted:z,onToggleComplete:function(e){var t=Object(s.a)(v),n=t.findIndex((function(t){return t.id===e}));t[n].completed=!t[n].completed,G(t),E(e,t[n].completed).then().catch((function(){R(T.UnableCompleteAction),t[n].completed=!t[n].completed,G(t)}))},onToggleAll:function(e){var t=e.target.checked,n=Object(s.a)(v).map((function(e){return Object(l.a)(Object(l.a)({},e),{},{completed:t})})),o=n.map((function(e){return E(e.id,t)}));G(n),Promise.all(o).then().catch((function(){R(T.UnableCompleteAction),G(Object(s.a)(v))}))},onDeleteTodo:function(e){var t=Object(s.a)(v).filter((function(t){return t.id!==e}));G(t),k(e).then().catch((function(){R(T.UnableCompleteAction),G(v)}))},onPatchTodo:function(e,t){var n=Object(s.a)(v).map((function(n){return n.id!==e?n:Object(l.a)(Object(l.a)({},n),{},{title:t})}));G(n),function(e,t){return N("/todos/".concat(e),{title:t})}(e,t).then().catch((function(){R(T.UnableCompleteAction),G(Object(s.a)(v))}))}}),v.length>0&&Object(p.jsx)(g,{activeTodosAmount:W.length,completedTodosAmount:q.length,onFilterTodos:I,onClearCompletedTodos:function(){var e=q.map((function(e){return k(e.id)}));G(W),Promise.all(e).then().catch((function(){R(T.UnableCompleteAction),G(Object(s.a)(v))}))}})]}),Object(p.jsx)(d.a,{nodeRef:e,in:i,timeout:300,children:function(t){return Object(p.jsxs)("div",{className:"error",ref:e,style:Object(l.a)(Object(l.a)({},H),B[t]),children:[J,Object(p.jsx)("button",{type:"button",className:"error__button","aria-label":"close__error",onClick:function(){return a(!1)}})]})}})]})};a.a.render(Object(p.jsx)(r.a,{children:Object(p.jsx)(S,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.078d52db.chunk.js.map